<% if user_signed_in? %>
    
    <% if current_user.id == @user.id%>
        <div class="title-box">
            <div class="page-title">あなたのvdot</div>
        </div>
        <br>
    <% else %>
      <div class="title-box">
        <div class="page-title"><%= "#{@user.nickname}さんのvdot" %></div>
      </div>
      <br>
    <% end %>

<% elsif @user.present? %>
  <div class="title-box">
    <div class="page-title"><%= "#{@user.nickname}さんのvdot" %></div>
  </div>
  <br>
<% end %>

<% if @user.present? && @five_vdot.present? && @ten_vdot.present? && @half_vdot.present? && @full_vdot.present? %>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.min.js" type="text/javascript"></script>

  <div class="mr-3">
  <canvas id="graph-area" height="300" width="660"></canvas>
  </div>
  <div class="d-flex justify-content-between mt-5 text-white bg-secondary p-3 ml-2 rounded">
     
    <div>
      5km：<%= @vdot_record_five.vdot %>
    </div>
    <div>
      10km：<%= @vdot_record_ten.vdot %>
    </div>
    <div>
      ハーフ：<%= @vdot_record_half.vdot %>
    </div>
    <div>
      フル：<%= @vdot_record_full.vdot %>
    </div>
  </div>
<% else %>  
  <div class="text-white">
    全ての距離のベストタイムを登録しよう！<br><br>
    グラフがでるよ！
  </div>
<% end %>


<br><br><br>

<div class="title-box">
  <div class="page-title">距離別の走力レベル</div>
</div>
<br>

<div class="content">
  <br>
  <% @vdot_records.each do |vdot_record| %>
    <div class="bg-light p-4 mb-3 rounded">

      <div class="vdot-number">
        <%= "vdot：#{vdot_record.vdot}" %>
      </div>  

      <div class="vdot-five d-flex align-items-center justify-content-between"> 
        5km　　　&nbsp;&nbsp;
        <div>
          <%= "#{vdot_record.five_km_minute}分" %>
          <%= "#{vdot_record.five_km_second}秒" %>
        </div>
        <div></div><div></div><div></div>
      </div>

      <div class="vdot-ten d-flex align-items-center justify-content-between">
        10km　　&nbsp;&nbsp;&nbsp;&nbsp;
        <div>
          <%= "#{vdot_record.ten_km_minute}分" %>
          <%= "#{vdot_record.ten_km_second}秒" %>
        </div>
        <div></div><div></div><div></div>
      </div>

      <div class="vdot-half d-flex align-items-center justify-content-between">  
        ハーフ
        <div>
          <%= "#{vdot_record.half_hour}時間" %>
          <%= "#{vdot_record.half_minute}分" %>
          <%= "#{vdot_record.half_second}秒" %>
        </div>
        <div></div><div></div><div></div>
      </div>

      <div class="vdot-full d-flex align-items-center justify-content-between">  
        フル&nbsp;&nbsp;&nbsp;
        <div>
          <%= "#{vdot_record.full_hour}時間" %>
          <%= "#{vdot_record.full_minute}分" %>
          <%= "#{vdot_record.full_second}秒" %>
        </div>
        <div></div><div></div><div></div>
      </div>

    </div>
  <% end %>
</div>  

<br><br><br>

<div class="title-box">
  <div class="page-title">走力別の練習目安ペース</div>
</div>

  <br>

<div class="content">  
  <% @vdot_paces.all.each do |vdot_pace| %>
    <div class="d-flex">
      <div class = "five hide-list">5km</div>
      <div class = "ten hide-list">10km</div>
      <div class = "half hide-list">ハーフ</div>
      <div class = "full hide-list">フル</div>
    </div>  
    <div class="vdot-pace bg-light p-4 rounded">

      <div class="vdot-number"><%= "vdot：#{vdot_pace.vdot}" %></div>

      <div class="d-flex align-items-center justify-content-between">
        <div>軽いジョギング　　　</div>
        <div class="time-box"><%= vdot_pace.e_pace %></div>
        <div></div><div></div><div></div>
      </div>

       <div class="d-flex align-items-center justify-content-between">
        <div>フルの本番想定ペース<br>（20km〜）</div>
        <div class="time-box"><%= vdot_pace.m_pace %></div>
        <div></div><div></div><div></div>
      </div>

       <div class="d-flex align-items-center justify-content-between">
        <div>ペース走　　　　　　<br>（20分間）</div>
        <div class="time-box"><%=vdot_pace.t_pace_twenty %></div>
        <div></div><div></div><div></div>
      </div>

       <div class="d-flex align-items-center justify-content-between">
        <div>ペース走　　　　　　<br>（40分間）</div>
        <div class="time-box"><%=vdot_pace.t_pace_forty %></div>
        <div></div><div></div><div></div>
      </div>
      
    </div>
    <br>
  <% end %>
</div>


<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>

<% if @user.present? && @five_vdot.present? && @ten_vdot.present? && @half_vdot.present? && @full_vdot.present? %>

  <script type="text/javascript">
    const lineChartData = {
        labels : ["", "", "", "" ],
        datasets : [
          {
              label: "緑データ",
              fillColor : "rgba(92,220,92,0.2)", // 線から下端までを塗りつぶす色
              strokeColor : "rgba(92,220,92,1)", // 折れ線の色
              pointColor : "rgba(92,220,92,1)",  // ドットの塗りつぶし色
              pointStrokeColor : "white",        // ドットの枠線色
              pointHighlightFill : "yellow",     // マウスが載った際のドットの塗りつぶし色
              pointHighlightStroke : "green",    // マウスが載った際のドットの枠線色
              data : [ <%= @vdot_record_five.vdot %>,
                      <%= @vdot_record_ten.vdot %>,
                      <%= @vdot_record_half.vdot %>,
                      <%= @vdot_record_full.vdot %> ]       // 各点の値
                          
          },
        ]
    }

    window.onload = function(){
        const ctx = document.getElementById("graph-area").getContext("2d");
        window.myLine = new Chart(ctx).Line(lineChartData,{
        responsive : true
        });
    };

  </script>

<% end %>

<script>
  $(function(){
    $(".five").hide();
    $(".ten").hide();
    $(".half").hide();
    $(".full").hide();
      
    $(".vdot-five").eq(<%= @five_vdot %>).css("background-color", "pink");
    $(".vdot-pace").eq(<%= @five_vdot %>).css("border", "5px solid red");
    $(".five").eq(<%= @five_vdot %>).css("background-color", "pink");
    $(".five").eq(<%= @five_vdot %>).show();

    $(".vdot-ten").eq(<%= @ten_vdot %>).css("background-color", "violet");
    $(".vdot-pace").eq(<%= @ten_vdot %>).css("border", "5px solid red");
    $(".ten").eq(<%= @ten_vdot %>).css("background-color", "violet");
    $(".ten").eq(<%= @ten_vdot %>).show();


    $(".vdot-half").eq(<%= @half_vdot %>).css("background-color", "lightblue");
    $(".vdot-pace").eq(<%= @half_vdot %>).css("border", "5px solid red");
    $(".half").eq(<%= @half_vdot %>).css("background-color", "lightblue");
    $(".half").eq(<%= @half_vdot %>).show();

    $(".vdot-full").eq(<%= @full_vdot %>).css("background-color", "gold");
    $(".vdot-pace").eq(<%= @full_vdot %>).css("border", "5px solid red");
    $(".full").eq(<%= @full_vdot %>).css("background-color", "gold");
    $(".full").eq(<%= @full_vdot %>).show();

  });
</script>

